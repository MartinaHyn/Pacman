<html>

<head>
  <meta charset="UTF-8" />
  <title>Pacman</title>
</head>

<body>
  <div id="stage">
    <div id="pacman"></div>
  </div>
</body>

<script>
  const TILE_SIZE = 85;
  const STAGE_SIZE_X = 10*TILE_SIZE;
  const STAGE_SIZE_Y = 8*TILE_SIZE;
  
  document.body.style.margin = '0';

  const pacmanElm = document.querySelector('#pacman');
  pacmanElm.style.width = TILE_SIZE;
  pacmanElm.style.height = TILE_SIZE;
  pacmanElm.style.backgroundImage = 'url(img/pacboy-active-light.png)';
  pacmanElm.style.position = 'absolute';

  pacmanElm.style.backgroundPositionX = "left";
//  pacmanElm.style.backgroundPositionY = "99%";

  const stage = document.querySelector('#stage');
  stage.style.width = STAGE_SIZE_X;
  stage.style.height = STAGE_SIZE_Y;
  stage.style.backgroundImage = 'url(img/tile.png)';
  stage.style.position = 'absolute';
  
  let pacX = 0;
  let pacY = 0;
  let mouthOpen = true;

  const handleKeyDown = (event) => {
    if ((event.keyCode === 39) & (pacX + TILE_SIZE < STAGE_SIZE_X )){
      pacX += TILE_SIZE;
    }
    if ((event.keyCode === 37)  & (pacX > 0)) {
      pacX -= TILE_SIZE;
    }
    if ((event.keyCode === 40) & (pacY + TILE_SIZE < STAGE_SIZE_Y )) {
      pacY += TILE_SIZE;
    }
    if ((event.keyCode === 38) & (pacY > 0)) {
      pacY -= TILE_SIZE;
    }
// otevirani a zavirani ust pri kazdem kroku
    if (mouthOpen) {
      mouthOpen = false;
    }
    else {
      mouthOpen = true;
    }
    
    updatePacman(pacX, pacY, mouthOpen);
  };

  const updatePacman = (x, y, mouth) => {
    const pacmanElm = document.querySelector('#pacman');
    pacmanElm.style.left = x;
    pacmanElm.style.top = y;
    if (mouth) {
      pacmanElm.style.backgroundPositionX = "left";
    }
    else {
      pacmanElm.style.backgroundPositionX = "right";
    }
  };

  document.body.addEventListener('keydown', handleKeyDown);

  


</script>

</html>