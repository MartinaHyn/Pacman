<html>

<head>
  <meta charset="UTF-8" />
  <title>Pacman</title>
</head>

<body>
  <div id="stage">
    <div id="pacman"></div>
  </div>
</body>

<script>
  const TILE_SIZE = 85;
  const STAGE_SIZE_X = 10*TILE_SIZE;
  const STAGE_SIZE_Y = 8*TILE_SIZE;
  
  document.body.style.margin = '0';

  const pacmanElm = document.querySelector('#pacman');
  pacmanElm.style.width = TILE_SIZE;
  pacmanElm.style.height = TILE_SIZE;
  pacmanElm.style.backgroundImage = 'url(img/pacgirl-active-light.png)';
  pacmanElm.style.position = 'absolute';

  pacmanElm.style.backgroundPositionX = "left";
  pacmanElm.style.backgroundPositionY = "0%";

  const stage = document.querySelector('#stage');
  stage.style.width = STAGE_SIZE_X;
  stage.style.height = STAGE_SIZE_Y;
  stage.style.backgroundImage = 'url(img/tile.png)';
  stage.style.position = 'absolute';
  
  let pacX = 0;
  let pacY = 0;
  let mouthOpen = true;
  let direction = "33%"; /* 0=right, 33=left, 66=down, 99=up */

  const handleKeyDown = (event) => {
    if (event.keyCode === 39) { /* right */
      direction = "0%";
      if (pacX + TILE_SIZE < STAGE_SIZE_X ){
       pacX += TILE_SIZE;
      }
    }
    if (event.keyCode === 37) { /* left */
      direction = "33%";
      if (pacX > 0) {
        pacX -= TILE_SIZE;
      }
    }
    if (event.keyCode === 40) { /* down */
      direction = "66%";
      if (pacY + TILE_SIZE < STAGE_SIZE_Y ) {
        pacY += TILE_SIZE;
      }
    }
    if (event.keyCode === 38) { /* up */
      direction = "99%";
      if  (pacY > 0) {
        pacY -= TILE_SIZE;
      }
    }
// otevirani a zavirani ust pri kazdem kroku
    if (mouthOpen) {
      mouthOpen = false;
    }
    else {
      mouthOpen = true;
    }
    //update
    updatePacman(pacX, pacY, mouthOpen, direction);
  };

  const updatePacman = (x, y, mouth, dir) => {
    const pacmanElm = document.querySelector('#pacman');
    pacmanElm.style.left = x;
    pacmanElm.style.top = y;
    if (mouth) {
      pacmanElm.style.backgroundPositionX = "left";
    }
    else {
      pacmanElm.style.backgroundPositionX = "right";
    }
    pacmanElm.style.backgroundPositionY = dir;
  };

  document.body.addEventListener('keydown', handleKeyDown);

  


</script>

</html>